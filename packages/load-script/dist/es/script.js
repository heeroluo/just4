import{assignProps}from"@just4/util/index";import{concat}from"@just4/querystring/index";function createScript(n){const t=document.createElement("script");return n&&Object.keys(n).forEach((function(o){const e=o;t[e]=n[e]})),t}export function loadScript(n,t){return new Promise((function(o,e){let r,c;function i(){r&&(r.onload=r.onerror=null,r.parentNode&&r.parentNode.removeChild(r),r=null),c&&window.clearTimeout(c)}const a=assignProps({preventCaching:!1,props:{async:!0}},t);a.data&&(n=concat(n,a.data)),a.preventCaching&&(n=concat(n,{_:Date.now()})),r=createScript(a.props),r.onload=function(){i(),o()},r.onerror=function(){i(),e(new Error('Fail to load "'+n+'"'))},r.src=n,document.head.appendChild(r);const u=Number(a.timeout);u>0&&(c=window.setTimeout((function(){i(),e(new Error('Request "'+n+'" timeout'))}),u))}))}