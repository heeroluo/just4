import{hasOwnProp,assignProps}from"@just4/util/object";export function parse(n,e){if("string"!=typeof n)throw new Error("The str argument must be a string type");(e=assignProps({},e)).decode=e.decode||decodeURIComponent;const o=Object.create(null);return n.split("&").forEach((function(n){if(!n)return;const r=n.split("=");let t=r[0],i=r[1]||"";(null==e?void 0:e.decode)&&(t=e.decode(t),i=e.decode(i)),hasOwnProp(o,t)?(Array.isArray(o[t])||(o[t]=[o[t]]),o[t].push(i)):o[t]=i})),o}export function stringify(n,e){e=assignProps({encode:encodeURIComponent,ignoreEmpty:!1},e);const o=[];function r(n,r){null==r&&(r=""),""===r&&(null==e?void 0:e.ignoreEmpty)||("function"==typeof(null==e?void 0:e.encode)&&(n=e.encode(n),r=e.encode(String(r))),o.push(n+"="+r))}let t,i;function s(n){r(t,n)}for(t in n)hasOwnProp(n,t)&&(i=n[t],Array.isArray(i)?i.forEach(s):r(t,i));return o.join("&")}export function appendToURL(n,e,o){if(null==n||null==e)return n;const r=(n=String(n)).indexOf("#");let t="";return-1!==r&&(t=n.substring(r,n.length),n=n.substring(0,r)),(n=n.replace(/[?&]$/,""))+((e="string"!=typeof e?stringify(e,o):e.replace(/^[?&]/,""))?(-1!==n.indexOf("?")?"&":"?")+e:"")+t}