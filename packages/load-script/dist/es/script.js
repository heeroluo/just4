import{assignProps}from"@just4/util/index";import{appendToURL}from"@just4/querystring/index";function createScript(n){const o=document.createElement("script");return n&&Object.keys(n).forEach((function(e){const t=e;o[t]=n[t]})),o}export function loadScript(n,o){return new Promise((function(e,t){let r,i;function c(){r&&(r.onload=r.onerror=null,r.parentNode&&r.parentNode.removeChild(r),r=null),i&&window.clearTimeout(i)}const a=assignProps({preventCaching:!1,props:{async:!0}},o);a.data&&(n=appendToURL(n,a.data)),a.preventCaching&&(n=appendToURL(n,{_:Date.now()})),r=createScript(a.props),r.onload=function(){c(),e()},r.onerror=function(){c(),t(new Error('Fail to load "'+n+'"'))},r.src=n,document.head.appendChild(r);const p=Number(a.timeout);p>0&&(i=window.setTimeout((function(){c(),t(new Error('Request "'+n+'" timeout'))}),p))}))}