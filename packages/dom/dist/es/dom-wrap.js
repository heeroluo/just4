import{toArray,mergeArray,isArrayLike}from"@just4/util/array";import{querySelectorAll}from"./selector";import{isNode,access,uniqueSort}from"./internal/dom-base";import{getAttr,setAttr,removeAttr,getProp,setProp}from"./internal/dom-attr";import{getData,setData,removeData,clearData}from"./internal/dom-data";import{getStyle,setStyle,show,hide}from"./internal/dom-style";import{addClass,removeClass,hasClass,toggleClass}from"./internal/dom-class";import{computeSize}from"./internal/dom-size";import{getScroll,setScroll}from"./internal/dom-scroll";import{getOffset}from"./internal/dom-offset";import{findElements,findElementsUntil,getChildren,getSiblings,getIndex}from"./internal/dom-traversal";import{insertToRefs,insertRefsTo,hasParent,canHasChild,appendChild,prependChild,insertBefore,insertAfter,replaceWith,removeNodes,removeDescendantNodes,cloneNode}from"./internal/dom-insertion";import{onEvent,offEvent,triggerEvent}from"./internal/dom-event";export class DOMWrap{constructor(e){this.length=0;const t=e?e.length:-1;if(isNaN(t)||t<0)return;let r=-1;for(;++r<t;)this[r]=e[r];this.length=t}toArray(){return toArray(this)}indexOf(e){return Array.prototype.indexOf.call(this,e)}forEach(e){return Array.prototype.forEach.call(this,e)}some(e){return Array.prototype.some.call(this,e)}every(e){return Array.prototype.every.call(this,e)}filter(e){return new DOMWrap(Array.prototype.filter.call(this,e))}get(e){return(e|=0)<0?this[this.length+e]:this[e]}eq(e){const t=this.get(e);return new DOMWrap(t?[t]:[])}first(){return this.eq(0)}last(){return this.eq(this.length-1)}add(e,t=document){return new DOMWrap(uniqueSort(mergeArray(this.toArray(),isArrayLike(e)?e:querySelectorAll(e,t))))}each(e){for(let t=0;t<this.length&&!1!==e.call(this[t],t,this[t]);t++);return this}attr(e,t){return access(this,e,t,!0,{get:getAttr,set:setAttr})}removeAttr(e){return removeAttr(this,e),this}prop(e,t){return access(this,e,t,!0,{get:getProp,set:setProp})}data(e,t){return access(this,e,t,!0,{get:getData,set:setData})}removeData(e){return null!=e?removeData(this,e):clearData(this),this}html(e){return this.prop("innerHTML",e)}text(e){return arguments.length?this.prop("textContent",e):this.prop("textContent")}val(e){return this.prop("value",e)}css(e,t){return access(this,e,t,!0,{get:getStyle,set:setStyle})}show(){return show(this),this}hide(){return hide(this),this}addClass(e){return addClass(this,e),this}removeClass(e){return removeClass(this,e),this}hasClass(e){return this.some((function(t){return hasClass(t,e)}))}toggleClass(e){return toggleClass(this,e),this}width(){return computeSize(this[0],"Width")}height(){return computeSize(this[0],"Height")}innerWidth(){return computeSize(this[0],"Width",!0)}innerHeight(){return computeSize(this[0],"Height",!0)}outerWidth(e){return computeSize(this[0],"Width",!0,!0,e)}outerHeight(e){return computeSize(this[0],"Height",!0,!0,e)}scrollTop(e){return access(this,"scrollTop",e,!0,{get:getScroll,set:setScroll})}scrollLeft(e){return access(this,"scrollLeft",e,!0,{get:getScroll,set:setScroll})}offset(){return getOffset(this[0])}index(){return getIndex(this[0])}children(e){return new DOMWrap(getChildren(this,e))}siblings(e){return new DOMWrap(getSiblings(this,e))}next(e){return new DOMWrap(findElements(this,"nextElementSibling",e,!0))}nextAll(e){return new DOMWrap(findElements(this,"nextElementSibling",e))}prev(e){return new DOMWrap(findElements(this,"previousElementSibling",e,!0))}prevAll(e){return new DOMWrap(findElements(this,"previousElementSibling",e))}parent(e){return new DOMWrap(findElements(this,"parentNode",e,!0))}parents(e){return new DOMWrap(findElements(this,"parentNode",e))}nextUntil(e,t){return new DOMWrap(findElementsUntil(this,"nextElementSibling",e,t))}prevUntil(e,t){return new DOMWrap(findElementsUntil(this,"previousElementSibling",e,t))}parentsUntil(e,t){return new DOMWrap(findElementsUntil(this,"parentNode",e,t))}append(e){return insertToRefs(e,this,appendChild,canHasChild),this}appendTo(e){return new DOMWrap(insertRefsTo(e,this,appendChild,canHasChild))}prepend(e){return insertToRefs(e,this,prependChild,canHasChild),this}prependTo(e){return new DOMWrap(insertRefsTo(e,this,prependChild,canHasChild))}before(e){return insertToRefs(e,this,insertBefore,hasParent),this}insertBefore(e){return new DOMWrap(insertRefsTo(e,this,insertBefore,hasParent))}after(e){return insertToRefs(e,this,insertAfter,hasParent),this}insertAfter(e){return new DOMWrap(insertRefsTo(e,this,insertAfter,hasParent))}replaceWith(e){return insertToRefs(e,this,replaceWith,hasParent),this}replaceAll(e){return new DOMWrap(insertRefsTo(e,this,replaceWith,hasParent))}remove(){return removeNodes(this),this}empty(){return removeDescendantNodes(this),this}clone(e,t){const r=[];return this.forEach((function(n){isNode(n)&&r.push(cloneNode(n,e,t))})),new DOMWrap(r)}on(e,t,r){return"function"==typeof t&&(r=t,t=void 0),onEvent(this,e,t,r),this}off(e,t,r){return"function"==typeof t&&(r=t,t=void 0),offEvent(this,e,t,r),this}trigger(e){return triggerEvent(this,e),this}focus(){return this.trigger("focus")}blur(){return this.trigger("blur")}click(){return this.trigger("click")}reset(){return this.trigger("reset")}submit(){return this.trigger("submit")}}