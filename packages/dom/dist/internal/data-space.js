import{isEmpty}from"@just4/util/object";import{getId}from"./dom-id";export class DataSpace{constructor(t={}){this._space=Object.create(null),this._cloneable=!1!==t.cloneable,this._onClone=t.onClone}findSpace(t){const e=getId(t,!0);if(e)return this._space[e]}keys(t){const e=this.findSpace(t);return e?Object.keys(e):[]}getData(t,e){const s=this.findSpace(t);if(s&&e in s)return s[e]}setData(t,e,s){const c=getId(t);c&&(this._space[c]||(this._space[c]=Object.create(null)),this._space[c][e]=s)}clearData(t){const e=getId(t,!0);e&&delete this._space[e]}removeData(t,e){const s=this.findSpace(t);s&&(delete s[e],isEmpty(s)&&this.clearData(t))}cloneData(t,e){if(!this._cloneable)return;const s=this.findSpace(e);if(s){const c=getId(t);if(!c)return;const n=this._space[c]=this._space[c]||Object.create(null);for(const t in s)n[t]=s[t];this._onClone&&this._onClone(t,e)}}}