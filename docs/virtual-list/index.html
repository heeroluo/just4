<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@just4/virtual-list</title><meta name="description" content="Documentation for @just4/virtual-list"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@just4/virtual-list</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>@just4/virtual-list</h1></div><div class="tsd-panel tsd-typography"><a id="md:虚拟滚动列表" class="tsd-anchor"></a><h1 class="tsd-anchor-link">虚拟滚动列表<a href="#md:虚拟滚动列表" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>本模块提供基于原生 DOM 操作的高性能虚拟滚动列表工作流，适用于无限上拉/下拉数据列表、聊天记录等功能场景。</p>
<a id="md:使用" class="tsd-anchor"></a><h2 class="tsd-anchor-link">使用<a href="#md:使用" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="md:安装" class="tsd-anchor"></a><h3 class="tsd-anchor-link">安装<a href="#md:安装" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">i</span><span class="hl-1"> </span><span class="hl-2">@just4/virtual-list</span>
</code><button type="button">Copy</button></pre>

<a id="md:调用" class="tsd-anchor"></a><h3 class="tsd-anchor-link">调用<a href="#md:调用" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">VirtualList</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@just4/virtual-list&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">virtualList</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">VirtualList</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-7">// 初始化参数</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>初始化参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>container</td>
<td>HTMLElement</td>
<td>滚动容器（HTML 元素）。</td>
</tr>
<tr>
<td>itemKey</td>
<td>string</td>
<td>数据项的 key 属性。</td>
</tr>
<tr>
<td>maxItemCount</td>
<td>number</td>
<td>最大渲染的节点数，默认为 100</td>
</tr>
<tr>
<td>prefetchDistance</td>
<td>number</td>
<td>预加载距离，为滚动容器高度的倍数，默认为 2。</td>
</tr>
<tr>
<td>defaultView</td>
<td>'head' | 'foot'</td>
<td>默认视图，'head' 表示开头，'foot' 表示末尾。</td>
</tr>
<tr>
<td>dataSource</td>
<td>Object</td>
<td>数据源（详见下文说明）。</td>
</tr>
<tr>
<td>renderer</td>
<td>Object</td>
<td>渲染器（详见下文说明）。</td>
</tr>
</tbody>
</table>
<a id="md:数据源（datasource）" class="tsd-anchor"></a><h3 class="tsd-anchor-link">数据源（dataSource）<a href="#md:数据源（datasource）" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><code>VirtualList</code> 对象会调用数据源去加载所需的数据，包括初始数据、下一页数据和上一页数据。数据源应包含以下<strong>异步方法</strong>：</p>
<ul>
<li><code>loadInitialData()</code>：加载初始数据。</li>
<li><code>loadNextData(ref)</code>：加载下一页数据，其中 ref 是当前最后一条数据的 key 值。</li>
<li><code>loadPreviousData(ref)</code>：加载上一页数据，其中 ref 是当前第一条数据的 key 值。</li>
</ul>
<p>以下为数据源对象的示例：</p>
<pre><code class="javascript"><span class="hl-7">// 假设 allData 中包含所有数据</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">allData</span><span class="hl-1"> = [</span><br/><span class="hl-1">  </span><span class="hl-7">// ...</span><br/><span class="hl-1">];</span><br/><br/><span class="hl-7">// 分页的页大小</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">PAGE_SIZE</span><span class="hl-1"> = </span><span class="hl-8">50</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">dataSource</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-0">loadInitialData</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-9">Promise</span><span class="hl-1">((</span><span class="hl-4">resolve</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">// setTimeout 用于模拟数据加载的延迟</span><br/><span class="hl-1">      </span><span class="hl-0">setTimeout</span><span class="hl-1">(</span><span class="hl-5">function</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-0">resolve</span><span class="hl-1">(</span><br/><span class="hl-1">          {</span><br/><span class="hl-1">            </span><span class="hl-4">data:</span><span class="hl-1"> </span><span class="hl-4">allData</span><span class="hl-1">.</span><span class="hl-0">slice</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-6">PAGE_SIZE</span><span class="hl-1">),</span><br/><span class="hl-1">            </span><span class="hl-4">reachedFootBoundary:</span><span class="hl-1"> </span><span class="hl-5">false</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-4">reachedHeadBoundary:</span><span class="hl-1"> </span><span class="hl-5">true</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">        );</span><br/><span class="hl-1">      }, </span><span class="hl-8">500</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  },</span><br/><br/><span class="hl-1">  </span><span class="hl-0">loadNextData</span><span class="hl-1">(</span><span class="hl-4">ref</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-9">Promise</span><span class="hl-1">((</span><span class="hl-4">resolve</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">setTimeout</span><span class="hl-1">(</span><span class="hl-5">function</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-3">for</span><span class="hl-1"> (</span><span class="hl-5">let</span><span class="hl-1"> </span><span class="hl-4">i</span><span class="hl-1"> = </span><span class="hl-8">0</span><span class="hl-1">; </span><span class="hl-4">i</span><span class="hl-1"> &lt; </span><span class="hl-4">allData</span><span class="hl-1">.</span><span class="hl-4">length</span><span class="hl-1">; </span><span class="hl-4">i</span><span class="hl-1">++) {</span><br/><span class="hl-1">          </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">allData</span><span class="hl-1">[</span><span class="hl-4">i</span><span class="hl-1">].</span><span class="hl-4">id</span><span class="hl-1">.</span><span class="hl-0">toString</span><span class="hl-1">() === </span><span class="hl-0">String</span><span class="hl-1">(</span><span class="hl-4">ref</span><span class="hl-1">)) {</span><br/><span class="hl-1">            </span><span class="hl-0">resolve</span><span class="hl-1">(</span><span class="hl-4">allData</span><span class="hl-1">.</span><span class="hl-0">slice</span><span class="hl-1">(</span><span class="hl-4">i</span><span class="hl-1"> + </span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-4">i</span><span class="hl-1"> + </span><span class="hl-8">1</span><span class="hl-1"> + </span><span class="hl-6">PAGE_SIZE</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-3">break</span><span class="hl-1">;</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">resolve</span><span class="hl-1">([]);</span><br/><span class="hl-1">      }, </span><span class="hl-8">500</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  },</span><br/><br/><span class="hl-1">  </span><span class="hl-0">loadPreviousData</span><span class="hl-1">(</span><span class="hl-4">ref</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-9">Promise</span><span class="hl-1">((</span><span class="hl-4">resolve</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">setTimeout</span><span class="hl-1">(</span><span class="hl-5">function</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-3">for</span><span class="hl-1"> (</span><span class="hl-5">let</span><span class="hl-1"> </span><span class="hl-4">i</span><span class="hl-1"> = </span><span class="hl-8">0</span><span class="hl-1">; </span><span class="hl-4">i</span><span class="hl-1"> &lt; </span><span class="hl-4">allData</span><span class="hl-1">.</span><span class="hl-4">length</span><span class="hl-1">; </span><span class="hl-4">i</span><span class="hl-1">++) {</span><br/><span class="hl-1">          </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">allData</span><span class="hl-1">[</span><span class="hl-4">i</span><span class="hl-1">].</span><span class="hl-4">id</span><span class="hl-1">.</span><span class="hl-0">toString</span><span class="hl-1">() === </span><span class="hl-0">String</span><span class="hl-1">(</span><span class="hl-4">ref</span><span class="hl-1">)) {</span><br/><span class="hl-1">            </span><span class="hl-0">resolve</span><span class="hl-1">(</span><span class="hl-4">allData</span><span class="hl-1">.</span><span class="hl-0">slice</span><span class="hl-1">(</span><span class="hl-4">Math</span><span class="hl-1">.</span><span class="hl-0">max</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-4">i</span><span class="hl-1"> - </span><span class="hl-6">PAGE_SIZE</span><span class="hl-1">), </span><span class="hl-4">i</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-3">break</span><span class="hl-1">;</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">resolve</span><span class="hl-1">([]);</span><br/><span class="hl-1">      }, </span><span class="hl-8">500</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<p><strong>如果返回的是空数组，则表示数据已到达边界，不会在该方向上继续加载</strong>。特别地，如果 <code>loadInitialData</code> 返回的是空数组，则表示当前没有数据，不会再触发 <code>loadNextData</code> 和 <code>loadPreviousData</code>。</p>
<a id="md:渲染器（renderer）" class="tsd-anchor"></a><h3 class="tsd-anchor-link">渲染器（renderer）<a href="#md:渲染器（renderer）" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>模块内部会把数据传入渲染器，并把渲染器返回的 DOM 节点渲染到容器内，渲染器是一个包含以下方法的对象：</p>
<ul>
<li><code>renderItems</code>：渲染数据项，需返回一个 DOM 节点的<strong>类数组或数组</strong>；</li>
<li><code>renderLoading</code>：渲染加载中界面，需返回 DOM 节点；</li>
<li><code>renderError</code>：渲染加载异常界面，需返回 DOM 节点；</li>
<li><code>renderBoundary</code>：渲染数据边界界面，需返回 DOM 节点；</li>
<li><code>renderEmpty</code>：渲染空数据提示，需返回 DOM 节点。</li>
</ul>
<p>其中 <code>renderLoading</code>、<code>renderError</code>、<code>renderBoundary</code> 的第一个参数为渲染位置、第二个参数为虚拟滚动列表的实例。渲染位置包括：</p>
<ul>
<li><code>RenderPosition.Main</code>：主位置，指的是没有数据时的状态。</li>
<li><code>RenderPosition.Head</code>：开头位置。</li>
<li><code>RenderPosition.Foot</code>：结尾位置。</li>
</ul>
<p>例如，如果只想在列表的结尾位置渲染边界界面，可以这么做：</p>
<pre><code class="javascript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">RenderPosition</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@just4/virtual-list/types&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">renderer</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-7">// ...</span><br/><br/><span class="hl-1">  </span><span class="hl-0">renderBoundary</span><span class="hl-1">(</span><span class="hl-4">position</span><span class="hl-1">, </span><span class="hl-4">instance</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">position</span><span class="hl-1"> === </span><span class="hl-4">RenderPosition</span><span class="hl-1">.</span><span class="hl-4">Foot</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">div</span><span class="hl-1"> = </span><span class="hl-4">document</span><span class="hl-1">.</span><span class="hl-0">createElement</span><span class="hl-1">(</span><span class="hl-2">&#39;div&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-4">div</span><span class="hl-1">.</span><span class="hl-4">className</span><span class="hl-1"> = </span><span class="hl-2">&#39;list-end&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">div</span><span class="hl-1">.</span><span class="hl-4">innerHTML</span><span class="hl-1"> = </span><span class="hl-2">&#39;没有更多数据了&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">div</span><span class="hl-1">.</span><span class="hl-0">onclick</span><span class="hl-1"> = </span><span class="hl-5">function</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-7">// instance 即为虚拟滚动列表实例</span><br/><span class="hl-1">        </span><span class="hl-4">instance</span><span class="hl-1">.</span><span class="hl-0">retryFetch</span><span class="hl-1">();</span><br/><span class="hl-1">      };</span><br/><span class="hl-1">      </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">div</span><span class="hl-1">;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<a id="md:事件" class="tsd-anchor"></a><h3 class="tsd-anchor-link">事件<a href="#md:事件" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><a id="md:单次渲染完成" class="tsd-anchor"></a><h4 class="tsd-anchor-link">单次渲染完成<a href="#md:单次渲染完成" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="javascript"><span class="hl-4">virtualList</span><span class="hl-1">.</span><span class="hl-0">on</span><span class="hl-1">(</span><span class="hl-2">&#39;rendered&#39;</span><span class="hl-1">, </span><span class="hl-5">function</span><span class="hl-1">(</span><span class="hl-4">args</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">dir</span><span class="hl-1">(</span><span class="hl-4">args</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>args 的类型说明见<a href="https://heeroluo.github.io/just4/virtual-list/interfaces/events.ItemClickEvent.html" target="_blank" class="external">文档</a>。</p>
<a id="md:点击数据项节点" class="tsd-anchor"></a><h4 class="tsd-anchor-link">点击数据项节点<a href="#md:点击数据项节点" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="javascript"><span class="hl-4">virtualList</span><span class="hl-1">.</span><span class="hl-0">on</span><span class="hl-1">(</span><span class="hl-2">&#39;item-click&#39;</span><span class="hl-1">, </span><span class="hl-5">function</span><span class="hl-1">(</span><span class="hl-4">args</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">dir</span><span class="hl-1">(</span><span class="hl-4">args</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>args 的类型说明见<a href="https://heeroluo.github.io/just4/virtual-list/interfaces/events.RenderedEvent.html" target="_blank" class="external">文档</a>。</p>
<a id="md:更新数据项" class="tsd-anchor"></a><h4 class="tsd-anchor-link">更新数据项<a href="#md:更新数据项" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="javascript"><span class="hl-4">virtualList</span><span class="hl-1">.</span><span class="hl-0">on</span><span class="hl-1">(</span><span class="hl-2">&#39;item-update&#39;</span><span class="hl-1">, </span><span class="hl-5">function</span><span class="hl-1">(</span><span class="hl-4">args</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">dir</span><span class="hl-1">(</span><span class="hl-4">args</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>args 的类型说明见<a href="https://heeroluo.github.io/just4/virtual-list/interfaces/events.ItemUpdateEvent.html" target="_blank" class="external">文档</a>。</p>
<a id="md:移除数据项" class="tsd-anchor"></a><h4 class="tsd-anchor-link">移除数据项<a href="#md:移除数据项" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>以下两种情况都会触发数据项的移除：</p>
<ul>
<li>数据量超出 <code>maxItemCount</code>；</li>
<li>调用 <code>removeItem</code> 或 <code>removeItems</code> 移除数据。</li>
</ul>
<pre><code class="javascript"><span class="hl-4">virtualList</span><span class="hl-1">.</span><span class="hl-0">on</span><span class="hl-1">(</span><span class="hl-2">&#39;item-remove&#39;</span><span class="hl-1">, </span><span class="hl-5">function</span><span class="hl-1">(</span><span class="hl-4">args</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">dir</span><span class="hl-1">(</span><span class="hl-4">args</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>args 的类型说明见<a href="https://heeroluo.github.io/just4/virtual-list/interfaces/events.ItemsRemoveEvent.html" target="_blank" class="external">文档</a>。</p>
<a id="md:获取当前数据项" class="tsd-anchor"></a><h3 class="tsd-anchor-link">获取当前数据项<a href="#md:获取当前数据项" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>可通过 <code>items</code> 属性获取当前数据项的集合。</p>
<pre><code class="javascript"><span class="hl-7">// 第一个数据项</span><br/><span class="hl-4">virtualList</span><span class="hl-1">.</span><span class="hl-4">items</span><span class="hl-1">.</span><span class="hl-0">first</span><span class="hl-1">();</span><br/><span class="hl-7">// 最后一个数据项</span><br/><span class="hl-4">virtualList</span><span class="hl-1">.</span><span class="hl-4">items</span><span class="hl-1">.</span><span class="hl-0">last</span><span class="hl-1">();</span><br/><span class="hl-7">// 遍历所有数据项</span><br/><span class="hl-3">for</span><span class="hl-1"> (</span><span class="hl-5">let</span><span class="hl-1"> </span><span class="hl-4">i</span><span class="hl-1"> = </span><span class="hl-8">0</span><span class="hl-1">; </span><span class="hl-4">i</span><span class="hl-1"> &lt; </span><span class="hl-4">virtualList</span><span class="hl-1">.</span><span class="hl-4">items</span><span class="hl-1">.</span><span class="hl-4">length</span><span class="hl-1">; </span><span class="hl-4">i</span><span class="hl-1">++) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">dir</span><span class="hl-1">(</span><span class="hl-4">virtualList</span><span class="hl-1">.</span><span class="hl-4">items</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-4">i</span><span class="hl-1">));</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="md:异常重试" class="tsd-anchor"></a><h3 class="tsd-anchor-link">异常重试<a href="#md:异常重试" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>如果在加载数据的过程中出现异常（Promise 返回 rejected 状态），那么在该方向上的滚动加载将会停止。此时可以通过界面上的交互引导用户手动点击重试。在重试操作中调用 <code>retryFetch</code> 这个方法。</p>
<p>注意：<code>retryFetch</code> 方法仅在加载异常和到达边界两种状态下可用，其他状态下将不会执行任何操作。</p>
<a id="md:其他" class="tsd-anchor"></a><h2 class="tsd-anchor-link">其他<a href="#md:其他" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><a href="https://heeroluo.github.io/just4/virtual-list/index.html" target="_blank" class="external">API 文档</a></li>
</ul>
<a id="md:changelog" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Changelog<a href="#md:changelog" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="md:v210" class="tsd-anchor"></a><h3 class="tsd-anchor-link">v2.1.0<a href="#md:v210" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>新增 <code>inited</code> 事件，在初始化结束后触发。</li>
<li>新增 <code>inited</code> getter，用于获取当前是否已初始化。</li>
</ul>
<a id="md:v200" class="tsd-anchor"></a><h3 class="tsd-anchor-link">v2.0.0<a href="#md:v200" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>事件发布/订阅机制更换为通过 <code>@just4/util/event</code> 中的 <code>PubSub</code> 实现。</li>
<li><code>VirtualListEvent</code> 不再是枚举类型，事件名通过字符串指定即可。</li>
</ul>
<a id="md:v100" class="tsd-anchor"></a><h3 class="tsd-anchor-link">v1.0.0<a href="#md:v100" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>允许通过 <code>setOptions</code> 更改 <code>defaultView</code> 选项。</li>
<li><code>loadNextData</code> 和 <code>loadPreviousData</code> 新增第二个参数，返回数据项的拷贝。</li>
<li>组件内的数据项列表为空时，不调用 <code>loadNextData</code> 和 <code>loadPreviousData</code>，而不是传入 <code>null</code> 去调用它们。</li>
<li><code>scrollToHead</code> 和 <code>scrollToFoot</code> 新增 <code>exceptState</code> 参数，用于指定是否排除状态节点。</li>
<li>新增 <code>removeItems</code> 方法，用于移除多个数据项。</li>
<li>移除数据项后，会检查当前是否处于预加载的范围内。</li>
<li>如果所有数据项都被清空，会先触发刷新，而不是直接显示空状态。</li>
<li>在空状态下，调用 <code>resetBoundaryState</code> 会触发刷新，重新请求初始数据。</li>
<li>执行 <code>resetBoundaryState</code> 重置状态之后，会检查当前是否处于预加载的范围内。</li>
<li>优化预加载范围检查的执行频率。</li>
<li>其他代码优化。</li>
</ul>
<a id="md:v0120" class="tsd-anchor"></a><h3 class="tsd-anchor-link">v0.12.0<a href="#md:v0120" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>修复容器不可见时节点不会被渲染的问题。</li>
</ul>
<a id="md:v0110" class="tsd-anchor"></a><h3 class="tsd-anchor-link">v0.11.0<a href="#md:v0110" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>优化位置检查逻辑的触发时机和频率。</li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:虚拟滚动列表"><span>虚拟滚动列表</span></a><ul><li><a href="#md:使用"><span>使用</span></a></li><li><ul><li><a href="#md:安装"><span>安装</span></a></li><li><a href="#md:调用"><span>调用</span></a></li><li><a href="#md:数据源（datasource）"><span>数据源（data<wbr/>Source）</span></a></li><li><a href="#md:渲染器（renderer）"><span>渲染器（renderer）</span></a></li><li><a href="#md:事件"><span>事件</span></a></li><li><ul><li><a href="#md:单次渲染完成"><span>单次渲染完成</span></a></li><li><a href="#md:点击数据项节点"><span>点击数据项节点</span></a></li><li><a href="#md:更新数据项"><span>更新数据项</span></a></li><li><a href="#md:移除数据项"><span>移除数据项</span></a></li></ul></li><li><a href="#md:获取当前数据项"><span>获取当前数据项</span></a></li><li><a href="#md:异常重试"><span>异常重试</span></a></li></ul></li><li><a href="#md:其他"><span>其他</span></a></li><li><a href="#md:changelog"><span>Changelog</span></a></li><li><ul><li><a href="#md:v210"><span>v2.1.0</span></a></li><li><a href="#md:v200"><span>v2.0.0</span></a></li><li><a href="#md:v100"><span>v1.0.0</span></a></li><li><a href="#md:v0120"><span>v0.12.0</span></a></li><li><a href="#md:v0110"><span>v0.11.0</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>@just4/virtual-list</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
